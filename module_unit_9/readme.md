# SF Unit 9: Car price prediction
## Цель проекта: Предсказание стоимости автомобиля с помощью различных моделей ML и DL, используя различные типы данных.
- Соревнование на платформе Kaggle.
- Дан тренировочный датасет с харакеристиками и фотографиями автомобилей.
- Дан тестовый датасет с харакеристиками и фотографиями для определения классов автомобилей.

## Этапы проекта:
- Построить "наивную" модель для определения начальной метрики, которую будем улучшать.
- Провести подготовку данных для различных моделей.
- Построить, обучить и оптимизировать параметры моделей для различных типов данных.
- Объединить полученные модели в одну multiple inputs сеть.
- Протестировать проброс значимого признака.
- Получить высокий результат в соревновании на платформе Kaggle.

## Реализация проекта
### Этап 1: "Наивная" модель, EDA, CatBoostRegressor
- Ноутбук по этапу: [Part 1](part_1_catboost.ipynb "Этап 1")
- Построена "наивная" модель для задания начального ориентира по метрики.
- Точность "наивной" модели по метрике MAPE: 19.88%.
- Проведен анализ и обработка признаков.
- Сгенерированы новые признаки (feature engineering).
- Проведена оценка значимости признаков.
- Обработаны текстовые описания для передачи в NLP-модель (очистка, нормализация, лемматизация, удаление стоп-слов).
- Проведена нормализация и логарифмирование числовых признаков.
- Протестирована и настроена ML модель CatBoostRegressor.
- Точность CatBoostRegressor модели по метрике MAPE: 11.87%.

### Этап 2: Нейросетевая модель для табличных данных
- Ноутбук по этапу: [Part 2](part_2_nn.ipynb "Этап 2")
- Создана нейронная сеть для работы с табличными признаками.
- Настроены параметры сети (протестированы различные комбинации слоев, количества нейронов в слоях, варианты batch и dropout нормализации).
- Лучшая метрика на тестах: 12.72%.
- Применен Блендинг NN и Catboost - метрика: 11.52%.

### Этап 3: nn + nlp + multiple inputs модели
- Ноутбук по этапу: [Part 3](part_3_nlp.ipynb "Этап 3")
- Построена NLP модель для обработки тестовых описаний автомобиля.
- Данные NLP модели и NN модели объеденены в multiple inputs сеть.
- С помощью обработки текстов описаний удалось улучшить метрику в сравнении с предлагаемым ноутбуком baseline.
- В данной конфигурации достигнут показатель МАРЕ: 12.79%.

### Этап 4: nn + nlp + cv + multiple inputs
- Ноутбук по этапу: [Part 4](part_4_cv.ipynb "Этап 4")
- Предобработка изображений.
- Аугментация изображений
- Построены три сети для обработки каждого типа данных без "головы".
- Построена "голова" с multiple inputs для объединения трех сетей в одну.
- Метрика MAPE на данном этапе составила: 12.84%

### Этап 5: Проброс признака, настройка гиперпараметров
- Ноутбук по этапу: [Part 5](part_5.ipynb "Этап 5")
- Настроен проброс признака с nn-моделью.
- Протестированы варианты и настроены гиперпараметры сети:
    - Learning rate.
    - Количество слоев сетей.
    - Количество нейронов в слоях.
    - Dropout и batch нормализации.

## Итоговый результат
- Итоговый результат метрики MAPE: 11.42%.
